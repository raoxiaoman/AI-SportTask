# AI SportTask 需求文档

## 1. 概述
AI SportTask 是一款个人运动任务管理与打卡应用，帮助用户以动作为单位组织训练，制定训练计划，按日打卡并进行统计分析，提升训练执行力与习惯养成。

## 2. 术语定义
- 动作分组（ActionGroup）：用于组织同类训练动作的集合。
- 动作（Action）：具体的训练条目，包含步骤说明、默认时长与休息时长。
- 训练序列（Training Sequence）：按照动作的 `order_index` 生成的执行队列。
- 打卡（Checkin）：记录某日训练的完成状态与耗时的数据项。

## 3. 用户故事与验收标准
- 我可以创建动作分组，并在分组内维护动作与排序。
  - 验收：支持分组的新增/编辑/删除，分组下动作的新增/编辑/删除与排序；排序变更在训练执行中生效。
- 我可以执行训练，应用按序列提供计时与休息提示，允许跳过/重复。
  - 验收：执行界面显示当前动作、剩余时长、休息时长；可操作跳过与重复；计时准确且不中断。
- 我可以记录每天是否完成训练，并记录耗时、关联分组或动作。
  - 验收：完成训练后可创建打卡记录，包含日期、关联分组/动作（可选）、耗时与完成状态；同日多次打卡不冲突。
- 我可以查看统计，包括按日/周/月的训练次数与总时长，以及连续打卡天数。
  - 验收：统计页展示区间内次数与时长汇总、趋势图或列表、连续打卡天数与最大连续天数。

## 4. 功能需求
### 4.1 分组管理
- 新增/编辑/删除分组（`name`、`created_at`）。
- 查看分组下动作列表并调整顺序。

### 4.2 动作管理
- 新增/编辑/删除动作（`name`、`steps_text`、`default_time`、`rest_time`、`order_index`、`group_id`、`created_at`）。
- 支持在分组内调整 `order_index` 并即时生效。

### 4.3 训练执行
- 基于选定分组，按 `order_index` 生成训练序列。
- 提供动作计时与休息计时，允许跳过当前动作或重复执行动作。
- 训练完成后可快速创建对应打卡记录。

### 4.4 打卡记录
- 支持按日记录：`date`、可选 `group_id`/`action_id`、`duration`、`is_completed`。
- 支持查看历史打卡与明细。

### 4.5 数据统计
- 区间统计：日/周/月内训练次数与总时长。
- 连续打卡：当前连续天数与最大连续天数。
- 趋势展示：简单趋势图或列表汇总。

## 5. 数据模型
数据模型通过 SQLDelight 定义（`shared/src/commonMain/sqldelight/sporttask.sq:3-27`）。
- `action_group`：`id`（主键，自增）、`name`（非空）、`created_at`（文本）。
- `action`：`id`（主键，自增）、`group_id`（外键，指向分组）、`name`（非空）、`steps_text`、`default_time`（非空）、`rest_time`（非空）、`order_index`（非空）、`created_at`。
- `checkin`：`id`（主键，自增）、`date`（非空，`YYYY-MM-DD`）、`group_id`（可空）、`action_id`（可空）、`duration`、`is_completed`（0/1）。

## 6. 非功能需求
- 可用性：启动快速、操作流畅；关键交互无明显卡顿。
- 隐私与安全：数据本地优先存储；默认不上传云端；用户授权后才进行云同步（后续迭代）。
- 离线：核心功能在离线场景可用；连接恢复后进行必要的同步。
- 可靠性：计时准确、数据写入成功可回读；异常情况下不丢失已完成记录。

## 7. 交互流程（简要）
1) 创建分组 → 添加动作（设置时长/休息/排序）
2) 选择分组开始训练 → 逐个动作计时与休息 → 可跳过/重复
3) 训练完成 → 创建打卡记录（自动或确认）
4) 查看统计 → 按区间查看次数与时长 → 查看连续打卡

## 8. 平台与技术栈
- 平台：Android、iOS（Kotlin Multiplatform）
- UI：Compose Multiplatform
- 数据：SQLDelight（本地持久化）

## 9. 边界与约束
- 日期格式约定为 `YYYY-MM-DD`（`checkin.date`）。
- `is_completed` 使用 0/1 表示布尔状态。
- `default_time`、`rest_time`、`duration` 单位为秒。
- 初期不支持跨设备自动同步，云备份为后续迭代方向。

## 10. 迭代方向与里程碑（建议）
- v0.1 MVP：分组/动作管理、训练执行、打卡记录、基础统计。
- v0.2 提升：提醒通知（本地）、番茄式节奏、更多统计维度。
- v0.3 云能力：账户登录、云备份与同步、数据导入导出。